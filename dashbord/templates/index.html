<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Brent Oil Change Point Analysis</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="{{ url_for('static', filename='css/style.css') }}"
      rel="stylesheet"
    />
  </head>
  <body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
      <div class="container">
        <a class="navbar-brand" href="#">
          <i class="fas fa-chart-line me-2"></i>
          Brent Oil Change Point Analysis
        </a>
      </div>
    </nav>

    <div class="container-fluid mt-4">
      <!-- Header Section -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="card bg-gradient-primary text-white">
            <div class="card-body text-center">
              <h1 class="display-4 mb-3">
                <i class="fas fa-oil-can me-3"></i>
                Brent Oil Change Point Analysis
              </h1>
              <p class="lead">
                Advanced Bayesian change point detection for Brent oil price
                analysis
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- Main Content -->
      <div class="row">
        <!-- Left Panel - Data Upload and Controls -->
        <div class="col-lg-4">
          <!-- Data Upload Section -->
          <div class="card mb-4">
            <div class="card-header bg-primary text-white">
              <h5 class="mb-0">
                <i class="fas fa-upload me-2"></i>
                Data Upload
              </h5>
            </div>
            <div class="card-body">
              <!-- Oil Price Data Upload -->
              <div class="mb-4">
                <label class="form-label fw-bold">
                  <i class="fas fa-chart-line me-2"></i>
                  Oil Price Data (CSV)
                </label>
                <input
                  type="file"
                  class="form-control"
                  id="oilPriceFile"
                  accept=".csv"
                />
                <div class="form-text">
                  Upload CSV with 'Date' and 'Price' columns
                </div>
              </div>

              <!-- Event Data Upload -->
              <div class="mb-4">
                <label class="form-label fw-bold">
                  <i class="fas fa-calendar-alt me-2"></i>
                  Event Data (CSV) - Optional
                </label>
                <input
                  type="file"
                  class="form-control"
                  id="eventFile"
                  accept=".csv"
                />
                <div class="form-text">
                  Upload CSV with 'Date' and 'Event' columns
                </div>
              </div>

              <!-- Upload Buttons -->
              <div class="d-grid gap-2">
                <button class="btn btn-primary" onclick="uploadOilData()">
                  <i class="fas fa-upload me-2"></i>
                  Upload Oil Data
                </button>
                <button class="btn btn-secondary" onclick="uploadEventData()">
                  <i class="fas fa-upload me-2"></i>
                  Upload Event Data
                </button>
              </div>
            </div>
          </div>

          <!-- Analysis Controls -->
          <div class="card mb-4">
            <div class="card-header bg-success text-white">
              <h5 class="mb-0">
                <i class="fas fa-cogs me-2"></i>
                Analysis Controls
              </h5>
            </div>
            <div class="card-body">
              <div class="d-grid gap-2">
                <button
                  class="btn btn-success btn-lg"
                  onclick="runAnalysis()"
                  id="analyzeBtn"
                  disabled
                >
                  <i class="fas fa-play me-2"></i>
                  Run Change Point Analysis
                </button>
                <button
                  class="btn btn-info"
                  onclick="loadEvents()"
                  id="eventsBtn"
                  disabled
                >
                  <i class="fas fa-calendar-check me-2"></i>
                  View Event Correlations
                </button>
                <button
                  class="btn btn-warning"
                  onclick="downloadResults()"
                  id="downloadBtn"
                  disabled
                >
                  <i class="fas fa-download me-2"></i>
                  Download Results
                </button>
              </div>
            </div>
          </div>

          <!-- Status Panel -->
          <div class="card">
            <div class="card-header bg-info text-white">
              <h5 class="mb-0">
                <i class="fas fa-info-circle me-2"></i>
                Status
              </h5>
            </div>
            <div class="card-body">
              <div id="statusPanel">
                <div class="alert alert-info">
                  <i class="fas fa-info-circle me-2"></i>
                  Ready to upload data
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Right Panel - Results and Visualizations -->
        <div class="col-lg-8">
          <!-- Loading Spinner -->
          <div id="loadingSpinner" class="text-center d-none">
            <div
              class="spinner-border text-primary"
              role="status"
              style="width: 3rem; height: 3rem"
            >
              <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-3">
              Running Bayesian analysis... This may take a few minutes.
            </p>
          </div>

          <!-- Results Section -->
          <div id="resultsSection" class="d-none">
            <!-- Analysis Summary -->
            <div class="card mb-4">
              <div class="card-header bg-success text-white">
                <h5 class="mb-0">
                  <i class="fas fa-chart-bar me-2"></i>
                  Analysis Summary
                </h5>
              </div>
              <div class="card-body">
                <div class="row" id="summaryStats">
                  <!-- Stats will be populated here -->
                </div>
              </div>
            </div>

            <!-- Visualizations -->
            <div class="card mb-4">
              <div class="card-header bg-primary text-white">
                <h5 class="mb-0">
                  <i class="fas fa-chart-area me-2"></i>
                  Visualizations
                </h5>
              </div>
              <div class="card-body">
                <ul class="nav nav-tabs" id="plotTabs" role="tablist">
                  <li class="nav-item" role="presentation">
                    <button
                      class="nav-link active"
                      id="time-series-tab"
                      data-bs-toggle="tab"
                      data-bs-target="#time-series"
                      type="button"
                      role="tab"
                    >
                      <i class="fas fa-chart-line me-2"></i>
                      Time Series
                    </button>
                  </li>
                  <li class="nav-item" role="presentation">
                    <button
                      class="nav-link"
                      id="posterior-tab"
                      data-bs-toggle="tab"
                      data-bs-target="#posterior"
                      type="button"
                      role="tab"
                    >
                      <i class="fas fa-chart-bar me-2"></i>
                      Posterior Distribution
                    </button>
                  </li>
                  <li class="nav-item" role="presentation">
                    <button
                      class="nav-link"
                      id="distributions-tab"
                      data-bs-toggle="tab"
                      data-bs-target="#distributions"
                      type="button"
                      role="tab"
                    >
                      <i class="fas fa-chart-pie me-2"></i>
                      Price Distributions
                    </button>
                  </li>
                </ul>
                <div class="tab-content mt-3" id="plotTabContent">
                  <div
                    class="tab-pane fade show active"
                    id="time-series"
                    role="tabpanel"
                  >
                    <div class="text-center">
                      <img
                        id="timeSeriesPlot"
                        class="img-fluid"
                        alt="Time Series Plot"
                      />
                    </div>
                  </div>
                  <div class="tab-pane fade" id="posterior" role="tabpanel">
                    <div class="text-center">
                      <img
                        id="posteriorPlot"
                        class="img-fluid"
                        alt="Posterior Distribution Plot"
                      />
                    </div>
                  </div>
                  <div class="tab-pane fade" id="distributions" role="tabpanel">
                    <div class="text-center">
                      <img
                        id="distributionsPlot"
                        class="img-fluid"
                        alt="Price Distributions Plot"
                      />
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Event Correlations -->
            <div class="card" id="eventsCard" style="display: none">
              <div class="card-header bg-warning text-dark">
                <h5 class="mb-0">
                  <i class="fas fa-calendar-check me-2"></i>
                  Event Correlations
                </h5>
              </div>
              <div class="card-body">
                <div id="eventsContent">
                  <!-- Events will be populated here -->
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
  </body>
</html>
